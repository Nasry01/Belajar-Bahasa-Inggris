<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nasry's Grammar Lab</title>
    <style>
        :root { --primary: #2ecc71; --secondary: #3498db; --bg: #f5f6fa; --text: #2f3640; --success: #27ae60; --error: #e74c3c; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; padding: 20px; }
        .app-card { background: white; width: 100%; max-width: 550px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); padding: 40px; text-align: center; }
        .title-container { border-bottom: 2px solid #f1f2f6; padding-bottom: 20px; margin-bottom: 30px; }
        .main-title { font-size: 1.8rem; color: #2980b9; margin: 0; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .setup-group { margin-bottom: 20px; text-align: left; max-width: 350px; margin-left: auto; margin-right: auto; }
        .setup-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #34495e; font-size: 0.9rem; }
        select { width: 100%; padding: 12px; border: 2px solid #dcdde1; border-radius: 8px; font-size: 1rem; outline: none; background: white; }
        .level-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; }
        .btn-lvl { padding: 12px; border: 2px solid #dcdde1; border-radius: 8px; background: white; cursor: pointer; font-weight: 600; transition: 0.3s; }
        .btn-lvl:hover { border-color: var(--secondary); color: var(--secondary); background: #f0f7ff; }
        .hidden { display: none; }
        .q-text { font-size: 1.4rem; font-weight: 700; margin-bottom: 25px; color: var(--text); text-align: left; }
        .option { display: block; width: 100%; padding: 15px; margin-bottom: 12px; border: 2px solid #f1f2f6; border-radius: 10px; text-align: left; cursor: pointer; background: white; font-size: 1rem; }
        .feedback { padding: 20px; border-radius: 12px; margin-top: 20px; text-align: left; line-height: 1.6; }
        .correct-box { background: #e8f8f0; border: 2px solid var(--success); color: #1e5631; }
        .wrong-box { background: #fff5f5; border: 2px solid var(--error); color: #822727; }
        .highlight { color: var(--success); font-weight: bold; }
        .btn-next { width: 100%; margin-top: 20px; padding: 16px; border: none; background: #5f27cd; color: white; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 1.1rem; }
        .score-big { font-size: 4rem; font-weight: 800; color: var(--secondary); margin: 20px 0; }
        .footer-credit { margin-top: 30px; color: #bdc3c7; font-size: 0.9rem; }
        .footer-credit a { color: #bdc3c7; text-decoration: none; font-weight: bold; }
    </style>
</head>
<body>

<div class="app-card">
    <div id="menu-screen">
        <div class="title-container"><h1 class="main-title">Nasry's Grammar Lab ðŸ“–</h1></div>
        <p style="color: #7f8c8d; margin-bottom: 25px;">Atur jumlah soal acak yang ingin Anda kerjakan.</p>
        <div class="setup-group">
            <label>JUMLAH SOAL:</label>
            <select id="num-questions">
                <option value="2">2 Soal</option><option value="5">5 Soal</option><option value="10">10 Soal</option>
                <option value="20">20 Soal</option><option value="30">30 Soal</option><option value="50">50 Soal</option>
            </select>
        </div>
        <div class="setup-group">
            <label>PILIH TINGKAT KESULITAN:</label>
            <div class="level-grid">
                <button class="btn-lvl" onclick="startQuiz('Beginner')">ðŸŒ± Beginner</button>
                <button class="btn-lvl" onclick="startQuiz('Intermediate')">ðŸŒ¿ Intermediate</button>
            </div>
        </div>
        <div class="footer-credit">Created by <a href="https://instagram.com/mafinnasry_">@mafinnasry_</a></div>
    </div>

    <div id="quiz-screen" class="hidden">
        <div id="progress" style="text-align: right; color: #bdc3c7; margin-bottom: 10px; font-weight: bold;"></div>
        <p class="q-text" id="q-text"></p>
        <div id="options-container"></div>
        <div id="feedback" class="feedback hidden"></div>
        <button id="next-btn" class="btn-next hidden" onclick="nextQuestion()">Soal Selanjutnya</button>
    </div>

    <div id="result-screen" class="hidden">
        <h2>Latihan Selesai! ðŸŽ‰</h2>
        <div class="score-big" id="final-pct">0%</div>
        <p id="final-desc"></p>
        <button class="btn-next" onclick="location.reload()">Coba Lagi</button>
        <div class="footer-credit">Created by @mafinnasry_</div>
    </div>
</div>

<script>
    const soundCorrect = new Audio('https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3');
    const soundWrong = new Audio('https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3');
    
    const bankSoal = {
        'Beginner': [
            { q: "I ___ a student.", options: ["is", "am", "are"], correct: 1, exp: "Subjek 'I' menggunakan <span class='highlight'>am</span>." },
            { q: "You ___ my best friend.", options: ["is", "am", "are"], correct: 2, exp: "Subjek 'You' menggunakan <span class='highlight'>are</span>." },
            { q: "She ___ (like) pizza.", options: ["like", "likes", "liking"], correct: 1, exp: "Subjek tunggal 'She' mendapat tambahan <span class='highlight'>s</span> pada kata kerja." },
            { q: "They ___ playing football.", options: ["is", "am", "are"], correct: 2, exp: "Subjek jamak 'They' menggunakan <span class='highlight'>are</span>." },
            { q: "He ___ a new car.", options: ["have", "has", "having"], correct: 1, exp: "Subjek 'He' menggunakan <span class='highlight'>has</span>." },
            { q: "We ___ hungry.", options: ["is", "am", "are"], correct: 2, exp: "Subjek jamak 'We' menggunakan <span class='highlight'>are</span>." },
            { q: "It ___ a beautiful day.", options: ["is", "am", "are"], correct: 0, exp: "Subjek 'It' menggunakan <span class='highlight'>is</span>." },
            { q: "I ___ (not) like coffee.", options: ["do", "does", "am"], correct: 0, exp: "Subjek 'I' menggunakan <span class='highlight'>do</span> not." },
            { q: "___ she speak English?", options: ["Do", "Does", "Is"], correct: 1, exp: "Kalimat tanya untuk 'She' menggunakan <span class='highlight'>Does</span>." },
            { q: "Look! The baby ___.", options: ["sleep", "is sleeping", "sleeps"], correct: 1, exp: "Sedang berlangsung menggunakan <span class='highlight'>is + V-ing</span>." },
            { q: "There ___ a pen on the desk.", options: ["is", "am", "are"], correct: 0, exp: "Satu benda menggunakan <span class='highlight'>is</span>." },
            { q: "There ___ many birds.", options: ["is", "am", "are"], correct: 2, exp: "Banyak benda menggunakan <span class='highlight'>are</span>." },
            { q: "This is ___ apple.", options: ["a", "an", "the"], correct: 1, exp: "Kata berawalan vokal menggunakan <span class='highlight'>an</span>." },
            { q: "That is ___ book.", options: ["a", "an", "the"], correct: 0, exp: "Kata berawalan konsonan menggunakan <span class='highlight'>a</span>." },
            { q: "I go to school ___ 7 AM.", options: ["in", "at", "on"], correct: 1, exp: "Waktu jam menggunakan <span class='highlight'>at</span>." },
            { q: "My birthday is ___ October.", options: ["in", "at", "on"], correct: 0, exp: "Nama bulan menggunakan <span class='highlight'>in</span>." },
            { q: "The meeting is ___ Monday.", options: ["in", "at", "on"], correct: 2, exp: "Nama hari menggunakan <span class='highlight'>on</span>." },
            { q: "I have two ___.", options: ["child", "childrens", "children"], correct: 2, exp: "Jamak dari child adalah <span class='highlight'>children</span>." },
            { q: "She is ___ than her sister.", options: ["tall", "taller", "tallest"], correct: 1, exp: "Perbandingan menggunakan <span class='highlight'>taller</span>." },
            { q: "This is the ___ building.", options: ["big", "bigger", "biggest"], correct: 2, exp: "Paling besar menggunakan <span class='highlight'>biggest</span>." },
            { q: "Whose is this? It's ___.", options: ["my", "me", "mine"], correct: 2, exp: "Kata ganti milik adalah <span class='highlight'>mine</span>." },
            { q: "I ___ (watch) TV yesterday.", options: ["watch", "watched", "watching"], correct: 1, exp: "Lampau (V2) menggunakan <span class='highlight'>watched</span>." },
            { q: "We ___ (go) to Bali last week.", options: ["go", "went", "gone"], correct: 1, exp: "V2 dari go adalah <span class='highlight'>went</span>." },
            { q: "I can ___ swimming.", options: ["go", "goes", "going"], correct: 0, exp: "Setelah modal (can) gunakan kata kerja dasar." },
            { q: "___ you help me?", options: ["Can", "Do", "Are"], correct: 0, exp: "Menanyakan bantuan menggunakan <span class='highlight'>Can</span>." },
            { q: "This ___ his house.", options: ["is", "am", "are"], correct: 0, exp: "Singular menggunakan <span class='highlight'>is</span>." },
            { q: "Where ___ you from?", options: ["is", "am", "are"], correct: 2, exp: "You menggunakan <span class='highlight'>are</span>." },
            { q: "I ___ (see) him two days ago.", options: ["see", "saw", "seen"], correct: 1, exp: "Dua hari lalu (lampau) menggunakan <span class='highlight'>saw</span>." },
            { q: "They ___ not here.", options: ["is", "am", "are"], correct: 2, exp: "They menggunakan <span class='highlight'>are</span>." },
            { q: "Is ___ your phone?", options: ["this", "these", "those"], correct: 0, exp: "Satu benda (is) menggunakan <span class='highlight'>this</span>." },
            { q: "Are ___ your books?", options: ["this", "that", "these"], correct: 2, exp: "Banyak benda (are) menggunakan <span class='highlight'>these</span>." },
            { q: "I want ___ water.", options: ["a", "some", "any"], correct: 1, exp: "Kalimat positif benda tak hitung menggunakan <span class='highlight'>some</span>." },
            { q: "Do you have ___ questions?", options: ["some", "any", "a"], correct: 1, exp: "Kalimat tanya menggunakan <span class='highlight'>any</span>." },
            { q: "She ___ (not) have a car.", options: ["do", "does", "is"], correct: 1, exp: "She menggunakan <span class='highlight'>does</span>." },
            { q: "We ___ (buy) a gift tomorrow.", options: ["will buy", "bought", "buys"], correct: 0, exp: "Besok (future) menggunakan <span class='highlight'>will buy</span>." },
            { q: "I ___ my homework now.", options: ["do", "am doing", "did"], correct: 1, exp: "Sekarang (now) menggunakan <span class='highlight'>am doing</span>." },
            { q: "The sun ___ in the east.", options: ["rise", "rises", "rising"], correct: 1, exp: "Fakta umum menggunakan <span class='highlight'>rises</span>." },
            { q: "Cats ___ mice.", options: ["catch", "catches", "catching"], correct: 0, exp: "Jamak menggunakan kata dasar <span class='highlight'>catch</span>." },
            { q: "___ he a teacher?", options: ["Is", "Am", "Are"], correct: 0, exp: "He menggunakan <span class='highlight'>Is</span>." },
            { q: "This cake smells ___.", options: ["good", "well", "best"], correct: 0, exp: "Kata sifat <span class='highlight'>good</span> untuk menjelaskan benda." },
            { q: "I sing ___.", options: ["good", "well", "better"], correct: 1, exp: "Kata keterangan <span class='highlight'>well</span> untuk menjelaskan cara menyanyi." },
            { q: "How ___ is this book?", options: ["many", "much", "long"], correct: 1, exp: "Harga menggunakan <span class='highlight'>much</span>." },
            { q: "How ___ pens do you have?", options: ["many", "much", "any"], correct: 0, exp: "Benda hitung menggunakan <span class='highlight'>many</span>." },
            { q: "He is ___ (old) than me.", options: ["old", "older", "oldest"], correct: 1, exp: "Perbandingan menggunakan <span class='highlight'>older</span>." },
            { q: "I ___ (be) at home last night.", options: ["am", "was", "were"], correct: 1, exp: "Past 'I' adalah <span class='highlight'>was</span>." },
            { q: "They ___ (be) happy yesterday.", options: ["was", "were", "are"], correct: 1, exp: "Past 'They' adalah <span class='highlight'>were</span>." },
            { q: "She always ___ (study) hard.", options: ["study", "studies", "studying"], correct: 1, exp: "She menggunakan <span class='highlight'>studies</span>." },
            { q: "I ___ (forget) my umbrella.", options: ["forget", "forgot", "forgotten"], correct: 1, exp: "Lampau menggunakan <span class='highlight'>forgot</span>." },
            { q: "Please listen ___ me.", options: ["at", "to", "on"], correct: 1, exp: "Berpasangan dengan <span class='highlight'>to</span>." },
            { q: "We are proud ___ you.", options: ["of", "at", "to"], correct: 0, exp: "Berpasangan dengan <span class='highlight'>of</span>." }
        ],
        'Intermediate': [
            { q: "If I ___ you, I would go.", options: ["am", "was", "were"], correct: 2, exp: "Conditional type 2 menggunakan <span class='highlight'>were</span>." },
            { q: "The car ___ (repair) right now.", options: ["is repairing", "is being repaired", "repairs"], correct: 1, exp: "Pasif sedang: <span class='highlight'>is being + V3</span>." }
        ]
    };

    let questions = []; let currentIdx = 0; let score = 0;

    function startQuiz(lvl) {
        const count = parseInt(document.getElementById('num-questions').value);
        questions = bankSoal[lvl].sort(() => 0.5 - Math.random()).slice(0, count);
        document.getElementById('menu-screen').classList.add('hidden');
        document.getElementById('quiz-screen').classList.remove('hidden');
        loadQuestion();
    }

    function loadQuestion() {
        const data = questions[currentIdx];
        document.getElementById('progress').innerText = `${currentIdx + 1} / ${questions.length}`;
        document.getElementById('q-text').innerText = data.q;
        document.getElementById('feedback').classList.add('hidden');
        document.getElementById('next-btn').classList.add('hidden');
        const container = document.getElementById('options-container'); container.innerHTML = '';
        data.options.forEach((opt, i) => {
            const btn = document.createElement('button'); btn.className = 'option'; btn.innerText = opt;
            btn.onclick = () => check(i); container.appendChild(btn);
        });
    }

    function check(idx) {
        const data = questions[currentIdx]; const fb = document.getElementById('feedback'); fb.classList.remove('hidden');
        const btns = document.querySelectorAll('.option'); btns.forEach(b => b.style.pointerEvents = 'none');
        if(idx === data.correct) {
            score++; soundCorrect.play(); fb.className = "feedback correct-box";
            fb.innerHTML = `<b style="color:var(--success)">âœ“ Benar!</b><br>${data.exp}`;
            btns[idx].style.borderColor = "var(--success)";
        } else {
            soundWrong.play(); fb.className = "feedback wrong-box";
            fb.innerHTML = `<b style="color:var(--error)">âœ— Salah.</b><br>${data.exp}`;
            btns[idx].style.borderColor = "var(--error)";
            btns[data.correct].style.borderColor = "var(--success)"; btns[data.correct].style.background = "#e8f8f0";
        }
        document.getElementById('next-btn').classList.remove('hidden');
    }

    function nextQuestion() {
        currentIdx++;
        if(currentIdx < questions.length) loadQuestion(); else showResult();
    }

    function showResult() {
        document.getElementById('quiz-screen').classList.add('hidden');
        document.getElementById('result-screen').classList.remove('hidden');
        const pct = Math.round((score / questions.length) * 100);
        document.getElementById('final-pct').innerText = pct + "%";
        document.getElementById('final-desc').innerText = `Skor: ${score} benar dari ${questions.length} soal.`;
    }
</script>
</body>
</html>
